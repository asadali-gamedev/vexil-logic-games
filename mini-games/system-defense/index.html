<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <!-- SEO -->
    <meta name="description"
        content="Defend the system core in System Defense. A classic space shooter reborn with cyberpunk aesthetics. Blast glitches and survive the data stream.">
    <meta name="keywords"
        content="system defense, space shooter, shoot em up, galaga style, browser shooter, arcade games">

    <!-- Open Graph -->
    <meta property="og:title" content="System Defense | Cyberpunk Space Shooter">
    <meta property="og:description" content="Protect the core from incoming data threats. High-octane shooting action.">
    <meta property="og:image" content="https://vexillogic.com/assets/img/arcade_thumbnails/system_defense.png">
    <meta property="og:url" content="https://vexillogic.com/mini-games/system-defense/">

    <!-- Schema -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "VideoGame",
      "name": "System Defense",
      "genre": "Shooter",
      "gamePlatform": "Web Browser",
      "url": "https://vexillogic.com/mini-games/system-defense/",
      "image": "https://vexillogic.com/assets/img/arcade_thumbnails/system_defense.png",
      "author": { "@type": "Organization", "name": "Vexil Logic Games" }
    }
    </script>

    <title>System Defense | Vexil Logic Games</title>
    <link rel="icon" href="../../assets/img/favicon.png" sizes="20x20" type="image/png">
    <link href="https://fonts.googleapis.com/css2?family=Science+Gothic:wght@400;700;900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --neon-green: #44f580;
            --neon-red: #ff003c;
            --neon-blue: #00f0ff;
            --deep-void: #050510;
        }

        body {
            margin: 0;
            overflow: hidden;
            background-color: var(--deep-void);
            font-family: 'Rajdhani', sans-serif;
            color: #fff;
            touch-action: none;
            user-select: none;
        }

        canvas {
            display: block;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }

        .ui-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 2000;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .brand-header {
            width: 100%;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: linear-gradient(to bottom, rgba(5, 5, 16, 0.9), transparent);
            pointer-events: auto;
        }

        .back-btn {
            color: #fff;
            text-decoration: none;
            font-weight: bold;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: 0.3s;
        }

        .back-btn:hover {
            color: var(--neon-green);
            text-shadow: 0 0 10px var(--neon-green);
        }

        .brand-logo {
            font-family: 'Science Gothic', sans-serif;
            font-size: 1.5rem;
            letter-spacing: 2px;
            color: #fff;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
        }

        .hud {
            text-align: right;
        }

        .score {
            font-family: 'Science Gothic', sans-serif;
            font-size: 2.5rem;
            color: var(--neon-green);
            text-shadow: 0 0 15px var(--neon-green);
            margin: 0;
            line-height: 1;
        }

        .lives {
            font-size: 1.5rem;
            color: var(--neon-red);
            letter-spacing: 5px;
            margin-top: 5px;
        }

        .screen {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(5, 5, 16, 0.95);
            padding: 50px;
            border: 2px solid var(--neon-green);
            border-radius: 10px;
            text-align: center;
            pointer-events: auto;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            box-shadow: 0 0 50px rgba(68, 245, 128, 0.2);
            min-width: 350px;
            z-index: 50;
            backdrop-filter: blur(10px);
        }

        .hidden {
            display: none !important;
        }

        h1 {
            margin: 0;
            font-family: 'Science Gothic', sans-serif;
            font-size: 3.5rem;
            color: var(--neon-green);
            text-transform: uppercase;
            line-height: 1;
            text-shadow: 0 0 20px var(--neon-green);
        }

        p {
            color: #ccc;
            font-size: 1.1rem;
            margin: 0;
        }

        .btn {
            background: transparent;
            border: 1px solid var(--neon-green);
            color: var(--neon-green);
            padding: 15px 40px;
            font-size: 1.5rem;
            font-weight: 900;
            cursor: pointer;
            text-transform: uppercase;
            font-family: 'Rajdhani', sans-serif;
            transition: 0.2s;
            margin-top: 20px;
            position: relative;
            overflow: hidden;
        }

        .btn:hover {
            background: var(--neon-green);
            color: #000;
            box-shadow: 0 0 30px var(--neon-green);
        }

        .powerup-text {
            position: absolute;
            top: 30%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-family: 'Science Gothic', sans-serif;
            font-size: 4rem;
            color: #fff;
            text-shadow: 0 0 20px #fff;
            opacity: 0;
            transition: 0.5s;
            pointer-events: none;
            white-space: nowrap;
            scale: 0;
        }

        .powerup-text.show {
            opacity: 1;
            scale: 1;
        }

        /* Effects */
        .scanlines {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to bottom, rgba(255, 255, 255, 0), rgba(255, 255, 255, 0) 50%, rgba(0, 0, 0, 0.15) 50%, rgba(0, 0, 0, 0.15));
            background-size: 100% 4px;
            pointer-events: none;
            z-index: 100;
        }

        .damage-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, transparent 50%, rgba(255, 0, 60, 0.6) 100%);
            pointer-events: none;
            opacity: 0;
            transition: 0.2s;
            z-index: 90;
        }

        .damage-overlay.show {
            opacity: 1;
        }
    </style>
</head>

<body>
    <div class="scanlines"></div>
    <div class="damage-overlay" id="damageOverlay"></div>
    <div class="powerup-text" id="powerupText">SYSTEM OVERDRIVE</div>

    <canvas id="gameCanvas"></canvas>

    <div class="ui-layer">
        <div class="brand-header">
            <a href="../index.html" class="back-btn"><i class="fa-solid fa-arrow-left"></i> ARCADE NEXUS</a>
            <div class="hud">
                <div class="score" id="score">0</div>
                <div class="lives" id="lives">❤️❤️❤️</div>
            </div>
        </div>

        <div id="startScreen" class="screen">
            <h1>SYSTEM<br>DEFENSE</h1>
            <p>HYPER EDITION V4.0</p>
            <p style="font-size: 0.9rem; margin-top:10px;">MOUSE TO MOVE | CLICK TO EMP</p>
            <button class="btn" onclick="startGame()">ENGAGE SYSTEMS</button>
        </div>
        <div id="gameOverScreen" class="screen hidden">
            <h1 style="color:var(--neon-red);">CRITICAL<br>FAILURE</h1>
            <p>THREATS NEUTRALIZED: <span id="finalScore">0</span></p>
            <button class="btn" style="border-color:var(--neon-red); color:var(--neon-red)" onclick="startGame()">REBOOT
                SYSTEM</button>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        let width, height;
        let gameActive = false;
        let score = 0;
        let frames = 0;
        let lives = 3;
        let shake = 0;
        let difficulty = 1;

        // Player
        const player = { x: 0, y: 0, w: 40, h: 40, color: '#44f580', timer: 0, emp: 1 };
        const bullets = [];
        const enemies = [];
        const particles = [];
        const stars = [];

        function resize() {
            width = window.innerWidth;
            height = window.innerHeight;
            canvas.width = width;
            canvas.height = height;
            player.x = width / 2;
            player.y = height - 100;
            initStars();
        }
        window.addEventListener('resize', resize);

        function initStars() {
            stars.length = 0;
            for (let i = 0; i < 100; i++) stars.push({ x: Math.random() * width, y: Math.random() * height, speed: Math.random() * 5 + 1, size: Math.random() * 2 });
        }

        function startGame() {
            document.querySelectorAll('.screen').forEach(s => s.classList.add('hidden'));
            score = 0;
            lives = 3;
            frames = 0;
            difficulty = 1;
            player.emp = 1;
            bullets.length = 0;
            enemies.length = 0;
            particles.length = 0;
            updateUI();
            gameActive = true;
            animate();
        }

        function updateUI() {
            document.getElementById('score').innerText = score.toString().padStart(6, '0');
            document.getElementById('lives').innerHTML = '❤️'.repeat(lives);
        }

        function showPowerupText(text) {
            const el = document.getElementById('powerupText');
            el.innerText = text;
            el.classList.add('show');
            setTimeout(() => el.classList.remove('show'), 1500);
        }

        function triggerDamage() {
            const el = document.getElementById('damageOverlay');
            el.classList.add('show');
            setTimeout(() => el.classList.remove('show'), 200);
            shake = 20;
        }

        function animate() {
            if (!gameActive) return;
            requestAnimationFrame(animate);
            frames++;
            difficulty += 0.001;

            // Screen Shake
            let sx = 0, sy = 0;
            if (shake > 0) { sx = (Math.random() - 0.5) * shake; sy = (Math.random() - 0.5) * shake; shake *= 0.9; }

            ctx.clearRect(0, 0, width, height);
            ctx.save();
            ctx.translate(sx, sy);

            // Warp Speed Stars
            ctx.fillStyle = '#fff';
            stars.forEach(s => {
                s.y += s.speed * (difficulty > 5 ? 5 : difficulty); // Speed up
                if (s.y > height) { s.y = 0; s.x = Math.random() * width; }
                ctx.globalAlpha = 0.5;
                ctx.beginPath(); ctx.rect(s.x, s.y, s.size, s.speed * 2); ctx.fill(); // Stretch effect
            });
            ctx.globalAlpha = 1;

            // --- Player ---
            // Draw futuristic ship
            ctx.shadowBlur = 20; ctx.shadowColor = player.color; ctx.fillStyle = player.color;
            ctx.beginPath();
            ctx.moveTo(player.x, player.y - 30);
            ctx.lineTo(player.x - 20, player.y + 20);
            ctx.lineTo(player.x, player.y + 10);
            ctx.lineTo(player.x + 20, player.y + 20);
            ctx.closePath();
            ctx.fill();

            // Auto Fire
            if (frames % Math.max(5, 15 - Math.floor(difficulty)) === 0) { // Fire rate increases
                bullets.push({ x: player.x, y: player.y - 30, vy: -15, w: 4, h: 20, color: '#44f580' });
                // Side guns at high levels
                if (difficulty > 3) {
                    bullets.push({ x: player.x - 15, y: player.y, vy: -12, w: 2, h: 10, color: '#00f0ff' });
                    bullets.push({ x: player.x + 15, y: player.y, vy: -12, w: 2, h: 10, color: '#00f0ff' });
                }
            }

            // --- Enemies ---
            // Spawn
            if (frames % Math.max(20, 60 - Math.floor(difficulty * 5)) === 0) {
                let type = Math.random();
                if (type > 0.9) spawnEnemy('bomber');
                else if (type > 0.7) spawnEnemy('seeker');
                else spawnEnemy('drone');
            }

            function spawnEnemy(type) {
                let e = { x: Math.random() * (width - 50) + 25, y: -50, type: type, hp: 1, w: 30, h: 30, vx: 0, vy: 2 };
                if (type === 'bomber') { e.hp = 10; e.w = 60; e.h = 60; e.vy = 1; e.color = '#ff003c'; }
                if (type === 'seeker') { e.hp = 3; e.w = 40; e.h = 40; e.vy = 3; e.color = '#d300ff'; }
                if (type === 'drone') { e.hp = 2; e.vy = Math.random() * 2 + 2; e.color = '#ff9900'; }
                enemies.push(e);
            }

            // Update Bullets
            bullets.forEach((b, i) => {
                b.y += b.vy;
                ctx.shadowColor = b.color; ctx.fillStyle = b.color;
                ctx.fillRect(b.x - b.w / 2, b.y, b.w, b.h);
                if (b.y < 0) bullets.splice(i, 1);
            });

            // Update Enemies
            enemies.forEach((e, i) => {
                // Movement Logic
                if (e.type === 'seeker') {
                    if (e.x < player.x) e.x += 1;
                    else e.x -= 1;
                }
                e.y += e.vy * difficulty;

                // Draw
                ctx.shadowColor = e.color; ctx.fillStyle = e.color;
                ctx.beginPath();
                if (e.type === 'bomber') {
                    // Hexagon
                    for (let j = 0; j < 6; j++) {
                        let angle = j * 2 * Math.PI / 6;
                        let px = e.x + e.w / 2 * Math.cos(angle);
                        let py = e.y + e.h / 2 * Math.sin(angle);
                        if (j === 0) ctx.moveTo(px, py); else ctx.lineTo(px, py);
                    }
                } else if (e.type === 'seeker') {
                    // Triangle pointing down
                    ctx.moveTo(e.x - e.w / 2, e.y - e.h / 2);
                    ctx.lineTo(e.x + e.w / 2, e.y - e.h / 2);
                    ctx.lineTo(e.x, e.y + e.h / 2);
                } else {
                    // Square
                    ctx.rect(e.x - e.w / 2, e.y - e.h / 2, e.w, e.h);
                }
                ctx.closePath();
                ctx.fill();

                // Collisions
                if (Math.hypot(e.x - player.x, e.y - player.y) < (e.w / 2 + 20)) {
                    lives--;
                    triggerDamage();
                    spawnParticles(player.x, player.y, '#ff003c', 30);
                    enemies.splice(i, 1);
                    updateUI();
                    if (lives <= 0) gameOver();
                }

                bullets.forEach((b, bi) => {
                    if (Math.hypot(e.x - b.x, e.y - b.y) < (e.w / 2 + b.w / 2)) {
                        e.hp--;
                        spawnParticles(b.x, b.y, '#fff', 3);
                        bullets.splice(bi, 1);
                        if (e.hp <= 0) {
                            score += e.type === 'bomber' ? 500 : 100;
                            updateUI();
                            spawnParticles(e.x, e.y, e.color, 20);
                            enemies.splice(i, 1);
                            shake = 5;
                        }
                    }
                });

                if (e.y > height + 50) enemies.splice(i, 1);
            });

            // Particles
            particles.forEach((p, i) => {
                p.x += p.vx; p.y += p.vy; p.alpha -= 0.05;
                ctx.shadowBlur = 0; ctx.globalAlpha = p.alpha; ctx.fillStyle = p.color;
                ctx.beginPath(); ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2); ctx.fill();
                ctx.globalAlpha = 1;
                if (p.alpha <= 0) particles.splice(i, 1);
            });

            ctx.restore();
        }

        function spawnParticles(x, y, color, count) {
            for (let i = 0; i < count; i++) {
                particles.push({
                    x: x, y: y,
                    vx: (Math.random() - 0.5) * 15, vy: (Math.random() - 0.5) * 15,
                    size: Math.random() * 4 + 1, alpha: 1, color: color
                });
            }
        }

        function gameOver() {
            gameActive = false;
            ArcadeProfile.reportGame('system-defense', score);
            document.getElementById('finalScore').innerText = score;
            document.getElementById('gameOverScreen').classList.remove('hidden');
        }

        // Input
        window.addEventListener('mousemove', (e) => { if (gameActive) player.x = e.clientX; });
        window.addEventListener('touchmove', (e) => { e.preventDefault(); if (gameActive) player.x = e.touches[0].clientX; }, { passive: false });

        // EMP
        window.addEventListener('mousedown', () => {
            if (gameActive && player.emp > 0) {
                // Nothing yet... maybe add later? Or straightforward shooting
            }
        });

        resize();
        initStars();
    </script>
    <script src="../../assets/js/arcade-profile.js"></script>
</body>

</html>